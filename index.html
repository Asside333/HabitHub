<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HabitHub — MVP offline</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main class="app-shell">
      <header class="hero" aria-label="En-tête de l'application">
        <div>
          <p class="hero-kicker">HabitHub</p>
          <h1>Transforme tes habitudes en mini-aventure</h1>
          <p class="subtitle">Quêtes rapides, récompenses instantanées, 100% hors ligne.</p>
        </div>
        <div class="hero-badges">
          <span class="badge" aria-label="Version MVP offline">MVP • Offline</span>
          <span id="level-badge" class="badge badge-level" aria-live="polite">Lv 1</span>
        </div>
      </header>

      <nav class="tabs app-nav" aria-label="Navigation principale">
        <button type="button" class="btn btn-ghost tab-btn is-active" data-tab-target="today" aria-controls="tab-today">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M12 4 4 10v10h16V10z"/><path d="M9 20v-6h6v6"/></svg></span>
          <span class="nav-label">Aujourd'hui</span>
        </button>
        <button type="button" class="btn btn-ghost tab-btn" data-tab-target="create" aria-controls="tab-create">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M4 6h16v14H4z"/><path d="M8 10h8M8 14h5" stroke="currentColor" stroke-width="2" fill="none"/></svg></span>
          <span class="nav-label">Catalogue</span>
        </button>
        <button type="button" class="btn btn-ghost tab-btn" data-tab-target="create" aria-controls="tab-create">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none"/></svg></span>
          <span class="nav-label">Créer</span>
        </button>
        <button type="button" class="btn btn-ghost tab-btn" data-tab-target="settings" aria-controls="tab-settings">
          <span class="nav-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M12 8.5A3.5 3.5 0 1 1 8.5 12 3.5 3.5 0 0 1 12 8.5z"/><path d="m20 13.2-1.6.5a6.7 6.7 0 0 1-.4 1l.9 1.4-1.8 1.8-1.4-.9a6.7 6.7 0 0 1-1 .4L13.2 20h-2.4l-.5-1.6a6.7 6.7 0 0 1-1-.4l-1.4.9-1.8-1.8.9-1.4a6.7 6.7 0 0 1-.4-1L4 13.2v-2.4l1.6-.5a6.7 6.7 0 0 1 .4-1L5 7.9l1.8-1.8 1.4.9a6.7 6.7 0 0 1 1-.4L10.8 4h2.4l.5 1.6a6.7 6.7 0 0 1 1 .4l1.4-.9L18 7.9l-.9 1.4a6.7 6.7 0 0 1 .4 1l1.6.5z"/></svg></span>
          <span class="nav-label">Réglages</span>
        </button>
      </nav>

      <section id="tab-today" data-tab-panel="today">
        <section class="card xp-hero" aria-live="polite" aria-labelledby="xp-hero-title">
          <div class="xp-hero-head">
            <h2 id="xp-hero-title">Niveau 1</h2>
            <p id="xp-hero-text" class="xp-hero-text">XP: 0 / 50</p>
          </div>
          <div class="progress-track xp-hero-track" id="xp-hero-track" role="progressbar" aria-label="Progression XP niveau actuel">
            <div id="xp-hero-bar" class="progress-fill xp-hero-fill"></div>
          </div>
          <p id="xp-hero-remaining" class="progress-subtext xp-hero-remaining">Reste: 50 XP</p>
        </section>

        <div class="layout-grid">
          <section class="card stats" aria-labelledby="stats-title">
            <div class="stats-head">
              <h2 id="stats-title">Progression</h2>
            </div>

            <div class="stats-grid">
              <article class="stat-card" aria-label="Points d'expérience">
                <div class="stat-icon" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M12 2 9.2 8.1 2.6 9l4.9 4.6-1.2 6.4L12 16.8 17.7 20l-1.2-6.4L21.4 9l-6.6-.9z" /></svg></div>
                <div><p class="label">XP total</p><strong id="xp-value" class="counter">0</strong></div>
              </article>
              <article class="stat-card" aria-label="Pièces d'or">
                <div class="stat-icon gold" aria-hidden="true"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="8" /><path d="M9.2 10.1c0-1.1.9-1.9 2.6-1.9 1.4 0 2.5.5 3.2 1.1l-1 1.6c-.6-.5-1.3-.8-2.1-.8-.7 0-1.1.2-1.1.6 0 .4.5.6 1.9 1 1.8.5 2.8 1.1 2.8 2.7 0 1.8-1.4 2.8-3.4 2.8-1.6 0-3-.5-3.9-1.4l1.1-1.5c.7.6 1.6 1.1 2.7 1.1.8 0 1.2-.2 1.2-.7 0-.4-.5-.6-1.8-1-1.9-.5-3-1.2-3-2.6z" /></svg></div>
                <div><p class="label">Gold</p><strong id="gold-value" class="counter">0</strong></div>
              </article>
            </div>

            <div class="session-progress" aria-live="polite">
              <div class="progress-label-row"><p class="label">Quêtes du jour</p><strong id="session-progress-text">0 / 0</strong></div>
              <div class="progress-track" id="session-progress-track" role="progressbar"><div id="session-progress-bar" class="progress-fill"></div></div>
            </div>

            <section class="progress-accordion" aria-live="polite">
              <details class="progress-card">
                <summary>Jour</summary>
                <div class="progress-card-body">
                  <div class="progress-label-row"><p class="label">Paliers du jour</p><strong id="daily-tier-status">Bronze dès 1</strong></div>
                  <p id="daily-tier-rule" class="progress-subtext">Argent dès 3 objectifs • Or dès 5 objectifs</p>
                  <div class="progress-label-row"><p class="label">Streak saine</p><strong id="streak-status">Streak: 0 jour(s)</strong></div>
                  <p id="streak-protections" class="progress-subtext">Shield: 1/1 • Rest cette semaine: 0/1 • Vacances restantes: 14</p>
                </div>
              </details>
              <details class="progress-card">
                <summary>Semaine</summary>
                <div class="progress-card-body">
                  <div class="progress-label-row"><p class="label">Progression hebdo</p><strong id="weekly-score-status">Score hebdo: 0</strong></div>
                  <p id="monthly-yearly-status" class="progress-subtext">Badge: - • Reliques: 0 • Milestones: 0</p>
                  <button id="claim-weekly-chest-btn" class="btn btn-success" type="button">Claim coffre hebdo</button>
                </div>
              </details>
              <details class="progress-card">
                <summary>Boss</summary>
                <div class="progress-card-body">
                  <p id="weekly-boss-status" class="progress-subtext">Boss: 0 / 0 • Streak boss: 0</p>
                </div>
              </details>
            </section>

            <div class="level-progress level-progress-secondary" aria-live="polite">
              <div class="progress-label-row"><p class="label">Niveau suivant</p><strong id="level-progress-text">XP: 0 / 0</strong></div>
              <div class="progress-track" id="level-progress-track" role="progressbar"><div id="level-progress-bar" class="progress-fill level-progress-fill"></div></div>
              <p id="level-progress-remaining" class="progress-subtext">Reste: 0 XP</p>
            </div>
          </section>

          <section class="card quests-section" aria-labelledby="quests-title">
            <h2 id="quests-title">Quêtes du jour</h2>
            <ul id="quests-list" class="quests-list"></ul>
          </section>
        </div>
      </section>

      <section id="tab-create" data-tab-panel="create" hidden>
        <section class="card manage-panel" aria-labelledby="create-title">
          <div class="create-toolbar">
            <h2 id="create-title">Catalogue des habitudes</h2>
            <div class="toolbar-row">
              <input id="catalog-search-input" type="search" placeholder="Rechercher une habitude…" />
              <button id="new-quest-btn" class="btn btn-primary" type="button">+ Nouvelle habitude</button>
            </div>
            <div class="toolbar-row toolbar-row-controls">
              <label class="control-field" for="catalog-filter-select">Afficher :
                <select id="catalog-filter-select">
                  <option value="all">Toutes</option>
                  <option value="visible">Visibles</option>
                  <option value="hidden">Masquées</option>
                  <option value="seed">Seed (de base)</option>
                  <option value="custom">Custom (personnalisées)</option>
                  <option value="overrides">Modifiées (overrides)</option>
                </select>
              </label>
              <label class="control-field" for="catalog-sort-select">Trier :
                <select id="catalog-sort-select">
                  <option value="recent">Récentes</option>
                  <option value="az">A–Z</option>
                  <option value="xpDesc">XP décroissant</option>
                  <option value="goldDesc">Gold décroissant</option>
                </select>
              </label>
              <p id="catalog-filter-pill" class="filter-pill" aria-live="polite"></p>
            </div>
            <div class="toolbar-row">
              <button id="bulk-hide-btn" class="btn btn-ghost" type="button">Masquer la sélection</button>
            </div>
          </div>
          <ul id="catalog-list" class="catalog-list"></ul>
        </section>
      </section>

      <section id="tab-settings" data-tab-panel="settings" hidden>
        <section class="card settings-panel" aria-labelledby="settings-title">
          <h2 id="settings-title">Réglages</h2>

          <article class="card settings-section" aria-labelledby="settings-general-title">
            <h3 id="settings-general-title">Général</h3>
            <div class="settings-row">
              <label class="toggle-field" for="haptics-toggle">
                <span>Vibrations :</span>
                <input id="haptics-toggle" type="checkbox" role="switch" />
                <strong id="haptics-toggle-state">ON</strong>
              </label>
            </div>
            <div class="settings-row">
              <label class="toggle-field" for="reduce-motion-toggle">
                <span>Réduire animations :</span>
                <input id="reduce-motion-toggle" type="checkbox" role="switch" />
                <strong id="reduce-motion-state">OFF</strong>
              </label>
            </div>
            <div class="settings-row">
              <label class="toggle-field" for="sounds-toggle">
                <span>Sons :</span>
                <input id="sounds-toggle" type="checkbox" role="switch" />
                <strong id="sounds-toggle-state">OFF</strong>
              </label>
            </div>
            <div class="settings-row" id="sounds-volume-row">
              <label class="control-field" for="sounds-volume-range">Volume (0–100)
                <input id="sounds-volume-range" type="range" min="0" max="100" step="1" value="70" />
              </label>
              <strong id="sounds-volume-value">70%</strong>
            </div>
            <div class="settings-row">
              <label class="toggle-field" for="developer-mode-toggle">
                <span>Mode développeur :</span>
                <input id="developer-mode-toggle" type="checkbox" role="switch" />
                <strong id="developer-mode-state">OFF</strong>
              </label>
            </div>
          </article>

          <article class="card settings-section" aria-labelledby="settings-gameplay-title">
            <h3 id="settings-gameplay-title">Gameplay</h3>
            <div class="settings-row">
              <label class="toggle-field" for="vacation-toggle">
                <span>Mode vacances :</span>
                <input id="vacation-toggle" type="checkbox" role="switch" />
                <strong id="vacation-state">OFF</strong>
              </label>
            </div>
            <p id="vacation-remaining-label" class="progress-subtext">Vacances restantes : 0</p>
          </article>

          <article id="developer-settings-section" class="card settings-section" aria-labelledby="settings-dev-title" hidden>
            <h3 id="settings-dev-title">Développeur</h3>
            <div class="settings-row">
              <label class="toggle-field" for="debug-date-toggle">
                <span>Use debug date :</span>
                <input id="debug-date-toggle" type="checkbox" role="switch" />
                <strong id="debug-date-state">OFF</strong>
              </label>
            </div>
            <label class="control-field" for="debug-date-input">Date simulée :
              <input id="debug-date-input" type="date" />
            </label>
            <p id="active-date-label" class="progress-subtext">Date active : -</p>
            <p id="dev-tech-info" class="progress-subtext">Clé save: habitrpg.save • Schéma: -</p>
          </article>

          <article class="card settings-section" aria-labelledby="settings-data-title">
            <h3 id="settings-data-title">Gestion des données</h3>
            <div class="settings-actions">
              <button id="reset-btn" class="btn btn-danger" type="button">Restart / Reset progression</button>
              <button id="catalog-reset-btn" class="btn btn-danger" type="button">Réinitialiser mon catalogue</button>
            </div>
          </article>
        </section>
      </section>
    </main>

    <div id="quest-editor-modal" class="editor-modal" hidden>
      <div id="editor-backdrop" class="editor-backdrop" data-action="close-editor"></div>
      <aside class="editor-panel" role="dialog" aria-modal="true" aria-labelledby="editor-title">
        <h3 id="editor-title">Nouvelle habitude</h3>
        <form id="quest-editor-form" class="quest-form" novalidate>
          <label class="form-field">Nom<input id="editor-title-input" type="text" minlength="2" maxlength="40" required /></label>
          <div class="form-grid">
            <label class="form-field">XP<input id="editor-xp-input" type="number" min="1" max="200" required /></label>
            <label class="form-field">Gold<input id="editor-gold-input" type="number" min="0" max="200" required /></label>
          </div>
          <label class="form-field">Rechercher une icône<input id="icon-search-input" type="search" placeholder="Ex: eau, sport..." /></label>
          <div id="icon-grid" class="icon-grid" role="listbox" aria-label="Choix d'icône"></div>
          <p id="editor-error" class="form-error" aria-live="polite"></p>
          <div class="form-actions">
            <button id="editor-save-btn" class="btn btn-primary" type="submit">Enregistrer</button>
            <button id="editor-cancel-btn" class="btn btn-ghost" type="button" data-action="close-editor">Annuler</button>
            <button id="editor-restore-btn" class="btn btn-ghost" type="button" hidden>Restaurer</button>
            <button id="editor-delete-btn" class="btn btn-danger" type="button" hidden>Supprimer</button>
          </div>
        </form>
      </aside>
    </div>

    <div id="level-up-overlay" class="level-up-overlay" hidden>
      <div class="level-up-modal" role="dialog" aria-modal="true" aria-labelledby="level-up-title" aria-describedby="level-up-message">
        <p id="level-up-title" class="hero-kicker">LEVEL UP</p>
        <h3 id="level-up-level">Niveau atteint</h3>
        <p id="level-up-message"></p>
        <button id="level-up-close-btn" class="btn btn-primary" type="button">Continuer</button>
      </div>
    </div>


    <div id="toast-root" class="toast-root" aria-live="polite" aria-atomic="false"></div>
    <script src="data.js"></script>
    <script src="game.js"></script>
  </body>
</html>
